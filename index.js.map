{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nexport let MAX_PAGE = 1;\n\nexport async function getImagesByQuery(query, page) {\n  axios.defaults.baseURL = 'https://pixabay.com';\n  const params = {\n    key: '51707366-c8695cacd8b805538752cece0',\n    q: `${query}`,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  };\n\n  try {\n    const res = await axios.get('/api/', { params });\n    MAX_PAGE = Math.ceil(res.data.totalHits / params.per_page);\n\n    const images = res.data.hits;\n    if (images && Array.isArray(images) && images.length > 0) {\n      return images;\n    } else {\n      return iziToast.show({\n        title: '❌',\n        message:\n          'Sorry, there are no images matching <br> your search query. Please try again!',\n        color: 'red',\n        position: 'topRight',\n        messageColor: 'white',\n        titleColor: 'white',\n      });\n    }\n  } catch (error) {\n    iziToast.show({\n      title: 'Error',\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n      message: error.message,\n    });\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { MAX_PAGE } from './pixabay-api';\nimport iziToast from 'izitoast';\n\nconst spanEl = document.querySelector('.loader');\nconst ulElem = document.querySelector('.gallery');\nconst btnLdMrEl = document.querySelector('.load-more');\n\nif (spanEl) {\n  spanEl.hidden = true;\n}\n\nconst gallery = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt', // Вказуємо, що підписи братимуться з атрибута 'alt' зображення\n  captionDelay: 250, // Затримка появи підпису\n});\n\nexport function createGallery(images) {\n  const markup = templatesImage(images);\n  ulElem.insertAdjacentHTML('afterbegin', markup);\n\n  gallery.refresh();\n}\n\nexport function updateGallery(images) {\n  const markup = templatesImage(images);\n  ulElem.insertAdjacentHTML('beforeend', markup);\n\n  gallery.refresh();\n}\n\nexport function clearGallery() {\n  ulElem.innerHTML = ``;\n}\n\nexport function showLoader(currentPage) {\n  spanEl.hidden = false;\n  if (currentPage > 1) {\n    spanEl.classList.add('load-more-loader');\n  }\n}\n\nexport function hideLoader() {\n  spanEl.hidden = true;\n}\n\nexport function checkVisibleLoadBtn(currentPage) {\n  if (currentPage < MAX_PAGE) {\n    showLoadMoreButton();\n  } else if (MAX_PAGE) {\n    hideLoadMoreButton();\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      color: 'blue',\n      position: 'topRight',\n      messageColor: 'black',\n    });\n  }\n}\n\nexport function scrollAfterUpdate() {\n  const cardEl = ulElem.querySelector('.gallery-item');\n\n  let rect = cardEl.getBoundingClientRect();\n\n  window.scrollBy({\n    top: rect.height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction showLoadMoreButton() {\n  btnLdMrEl.classList.add('is-visible');\n}\n\nexport function hideLoadMoreButton() {\n  btnLdMrEl.classList.remove('is-visible');\n}\n\nfunction templateImage(img) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = img;\n  return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n  </a><div class=\"stats\">\n  <p class=\"img-rates\">Likes<span>${likes}</span></p>\n  <p class=\"img-rates\">Views<span>${views}</span></p>\n  <p class=\"img-rates\">Comments<span>${comments}</span></p>\n  <p class=\"img-rates\">Downloads<span>${downloads}</span></p></div>\n</li>\n`;\n}\n\nfunction templatesImage(imgs) {\n  return imgs.map(templateImage).join('\\n');\n}\n","import { getImagesByQuery } from './js/pixabay-api';\nimport {\n  checkVisibleLoadBtn,\n  clearGallery,\n  createGallery,\n  hideLoader,\n  scrollAfterUpdate,\n  showLoader,\n  updateGallery,\n  hideLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formEl = document.querySelector('.form');\nconst btnLdMrEl = document.querySelector('.load-more');\n\nlet currentPage;\nlet query;\n\nformEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = e.currentTarget.elements['search-text'].value.trim();\n  if (!query) {\n    return iziToast.info({\n      message: 'Введіть запит',\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n  }\n  clearGallery();\n  hideLoadMoreButton();\n  currentPage = 1;\n\n  try {\n    showLoader(currentPage);\n    const images = await getImagesByQuery(query, currentPage);\n\n    if (images.length !== 0) {\n      createGallery(images);\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n    checkVisibleLoadBtn(currentPage);\n  }\n});\n\nbtnLdMrEl.addEventListener('click', async e => {\n  currentPage += 1;\n  hideLoadMoreButton();\n  try {\n    showLoader(currentPage);\n    const images = await getImagesByQuery(query, currentPage);\n    if (images.length > 0) {\n      updateGallery(images);\n      scrollAfterUpdate();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      color: 'red',\n      position: 'topRight',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n    checkVisibleLoadBtn(currentPage);\n  }\n});\n"],"names":["MAX_PAGE","getImagesByQuery","query","page","axios","params","res","images","iziToast","error","spanEl","ulElem","btnLdMrEl","gallery","SimpleLightbox","createGallery","markup","templatesImage","updateGallery","clearGallery","showLoader","currentPage","hideLoader","checkVisibleLoadBtn","showLoadMoreButton","hideLoadMoreButton","scrollAfterUpdate","rect","templateImage","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgs","formEl","e"],"mappings":"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"}